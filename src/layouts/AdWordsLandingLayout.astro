---
import BaseLayout from "./BaseLayout.astro";

export interface Props {
  title: string;
  description: string;
  keywords: string[];
  campaign?: string;
  adGroup?: string;
  variant?: string;
  structuredData?: object;
}

const {
  title,
  description,
  keywords,
  campaign,
  adGroup,
  variant = "A",
  structuredData,
} = Astro.props;

// Enhanced tracking for AdWords campaigns
const trackingParams = {
  utm_source: "google",
  utm_medium: "cpc",
  utm_campaign: campaign || "medical-services",
  utm_content: adGroup || "default",
  variant: variant,
};

// Conversion tracking setup
const conversionTracking = {
  googleAdsConversionId: "AW-XXXXXXXXX", // Replace with actual conversion ID
  googleAdsConversionLabel: "XXXXXXXXX", // Replace with actual label
  facebookPixelId: "XXXXXXXXX", // Replace with actual Facebook Pixel ID
};
---

<BaseLayout
  title={title}
  description={description}
  keywords={keywords}
  structuredData={structuredData}
>
  <!-- Google Ads Conversion Tracking -->
  <script
    type="text/partytown"
    async
    src="https://www.googletagmanager.com/gtag/js?id=AW-XXXXXXXXX"></script>
  <script type="text/partytown">
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());
    gtag("config", "AW-XXXXXXXXX");

    // Track landing page view
    gtag("event", "page_view", {
      campaign: "{campaign}",
      ad_group: "{adGroup}",
      variant: "{variant}",
    });
  </script>

  <!-- Facebook Pixel -->
  <script type="text/partytown">
    !(function (f, b, e, v, n, t, s) {
      if (f.fbq) return;
      n = f.fbq = function () {
        n.callMethod
          ? n.callMethod.apply(n, arguments)
          : n.queue.push(arguments);
      };
      if (!f._fbq) f._fbq = n;
      n.push = n;
      n.loaded = !0;
      n.version = "2.0";
      n.queue = [];
      t = b.createElement(e);
      t.async = !0;
      t.src = v;
      s = b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t, s);
    })(
      window,
      document,
      "script",
      "https://connect.facebook.net/en_US/fbevents.js"
    );
    fbq("init", "XXXXXXXXX");
    fbq("track", "PageView");
  </script>

  <!-- AdWords Landing Page Specific Styles -->
  <style>
    /* Conversion-focused styling */
    .cta-button {
      background: linear-gradient(
        to right,
        var(--color-accent),
        var(--color-accent-hover)
      );
      color: white;
      font-weight: 600;
      padding: 1rem 2rem;
      border-radius: 0.5rem;
      box-shadow:
        0 10px 15px -3px rgba(0, 0, 0, 0.1),
        0 4px 6px -2px rgba(0, 0, 0, 0.05);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    .cta-button:hover {
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
      transform: scale(1.05);
    }

    .trust-badge {
      background-color: white;
      border-radius: 0.5rem;
      box-shadow:
        0 4px 6px -1px rgba(0, 0, 0, 0.1),
        0 2px 4px -1px rgba(0, 0, 0, 0.06);
      padding: 1rem;
      border-left: 4px solid var(--color-primary);
    }

    .conversion-form {
      background-color: white;
      border-radius: 0.75rem;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
      padding: 2rem;
      border-top: 4px solid var(--color-primary);
    }

    .urgency-banner {
      background: linear-gradient(
        to right,
        var(--color-secondary),
        var(--color-secondary-hover)
      );
      color: white;
      text-align: center;
      padding: 0.5rem 0;
      font-weight: 600;
      animation: bounce 1s infinite;
    }

    @keyframes pulse {
      0%,
      100% {
        opacity: 1;
      }
      50% {
        opacity: 0.5;
      }
    }

    @keyframes bounce {
      0%,
      100% {
        transform: translateY(0);
        animation-timing-function: cubic-bezier(0.8, 0, 1, 1);
      }
      50% {
        transform: translateY(-25%);
        animation-timing-function: cubic-bezier(0, 0, 0.2, 1);
      }
    }
  </style>

  <main
    class="min-h-screen"
    style="background: linear-gradient(to bottom right, var(--color-primary-light), white);"
  >
    <!-- Urgency Banner -->
    <div class="urgency-banner">
      ðŸŽ¯ OfertÄƒ LimitatÄƒ: ConsultaÈ›ie GratuitÄƒ - Doar AstÄƒzi!
    </div>

    <slot />

    <!-- Conversion Tracking Scripts -->
    <script type="text/partytown">
      // Track form submissions
      function trackConversion(service) {
        gtag("event", "conversion", {
          send_to: "AW-XXXXXXXXX/XXXXXXXXX",
          value: 200.0,
          currency: "RON",
          transaction_id: Date.now().toString(),
          service: service,
        });

        fbq("track", "Lead", {
          value: 200.0,
          currency: "RON",
          content_name: service,
        });
      }

      // Track phone clicks
      function trackPhoneClick() {
        gtag("event", "phone_call", {
          event_category: "engagement",
          event_label: "header_phone",
        });
      }

      // Track CTA clicks
      function trackCTAClick(ctaType) {
        gtag("event", "cta_click", {
          event_category: "engagement",
          event_label: ctaType,
        });
      }
    </script>
  </main>
</BaseLayout>
