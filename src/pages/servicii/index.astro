---
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import AllServicesListing from "../../components/services/AllServicesListing.tsx";
import ServicesSection from "../../components/home/ServicesSection.tsx";
import ComingSoonSection from "../../components/home/ComingSoonSection.tsx";
import ServicesSearch from "../../components/services/ServicesSearch.tsx";
import AnimatedText from "../../components/magic-ui/AnimatedText.tsx";
import FloatingParticles from "../../components/magic-ui/FloatingParticles.tsx";
import { Image, getImage } from "astro:assets";
import { siteConfig } from "../../config/site";
import bgImage from "../../assets/images/bg-image.jpg";
import welcomeImage from "../../assets/images/welcome.webp";

// Import service images - toate serviciile cu imagini corecte
import medicinaFamilieImg from "../../assets/images/servicii/fam-scaled.webp";
import pediatrieImg from "../../assets/images/servicii/pediatrrie.webp";
import medicinaInternaImg from "../../assets/images/servicii/medicina-interna.webp";
import chirurgieGeneralaImg from "../../assets/images/servicii/chirurgie.webp";
import chirurgiePediatricaImg from "../../assets/images/servicii/CHIRURGIE-PEDIATRICA.webp";
import obstetricaGinecologieImg from "../../assets/images/servicii/ginecologie.webp";
import ortopedieTraumatologieImg from "../../assets/images/servicii/orto.webp";
import nefrologieImg from "../../assets/images/servicii/nefrologie.webp";
import analizeLaboratorImg from "../../assets/images/servicii/medicina-muncii.webp";
import dermatovenerologieImg from "../../assets/images/servicii/dermatologie.webp";
import medicinaMunciiImg from "../../assets/images/servicii/medicina-muncii.webp";
import neurologieImg from "../../assets/images/servicii/medicina-muncii.webp";
import esteticaImg from "../../assets/images/servicii/chirurgie.webp";

// Coming soon service images
import reumatologieImgSoon from "../../assets/images/servicii/soon/reumatologie.webp";
import pneumologieImgSoon from "../../assets/images/servicii/soon/pneumologie.webp";
import endocrinologieImgSoon from "../../assets/images/servicii/soon/endocrinologie.webp";
import psihiatrieImgSoon from "../../assets/images/servicii/soon/psihiatrie.webp";
import recuperareMedicalaImgSoon from "../../assets/images/servicii/soon/RECUPERARE-MEDICALA.webp";
import alergologieImgSoon from "../../assets/images/servicii/soon/alergologie.webp";
import ortopediePediatricaImgSoon from "../../assets/images/servicii/soon/ORTOPEDIE-PEDIATRICA.webp";
import cardiologieImgSoon from "../../assets/images/servicii/soon/cardiologie.webp";
import orlImgSoon from "../../assets/images/servicii/soon/ORL.webp";
import oftalmologieImgSoon from "../../assets/images/servicii/soon/oftamologie.webp";
import urologieImgSoon from "../../assets/images/servicii/soon/UROLOGIE.webp";

// Get all services content
const services = await getCollection("services");

// Filter out hidden services and sort by order and then by name
const sortedServices = services
  .filter((service) => service.data.hidden !== true)
  .sort((a, b) => {
    if (a.data.order !== b.data.order) {
      return (a.data.order || 999) - (b.data.order || 999);
    }
    return a.data.name.localeCompare(b.data.name, "ro");
  });

// Optimize background images
const optimizedBgImage = await getImage({
  src: bgImage,
  width: 1920,
  height: 1080,
  format: "webp",
  quality: 85,
});

const optimizedWelcomeImage = await getImage({
  src: welcomeImage,
  width: 600,
  height: 450,
  format: "webp",
  quality: 90,
});

// Optimize service images to actual display size (384x216)
const optimizedServiceImages = await Promise.all([
  getImage({
    src: medicinaFamilieImg,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: pediatrieImg,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: medicinaInternaImg,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: chirurgieGeneralaImg,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: chirurgiePediatricaImg,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: obstetricaGinecologieImg,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: ortopedieTraumatologieImg,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: nefrologieImg,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: analizeLaboratorImg,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: dermatovenerologieImg,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: medicinaMunciiImg,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: esteticaImg,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: neurologieImg,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  // Coming soon services
  getImage({
    src: reumatologieImgSoon,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: pneumologieImgSoon,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: endocrinologieImgSoon,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: psihiatrieImgSoon,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: recuperareMedicalaImgSoon,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: alergologieImgSoon,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: ortopediePediatricaImgSoon,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: cardiologieImgSoon,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: orlImgSoon,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: oftalmologieImgSoon,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
  getImage({
    src: urologieImgSoon,
    width: 384,
    height: 216,
    format: "webp",
    quality: 85,
  }),
]);

// Create service images mapping with optimized images
const serviceImages = {
  // Servicii disponibile acum - optimized images
  "medicina-familie": {
    src: optimizedServiceImages[0].src,
    width: 384,
    height: 216,
  },
  pediatrie: { src: optimizedServiceImages[1].src, width: 384, height: 216 },
  "medicina-interna": {
    src: optimizedServiceImages[2].src,
    width: 384,
    height: 216,
  },
  "chirurgie-generala": {
    src: optimizedServiceImages[3].src,
    width: 384,
    height: 216,
  },
  "chirurgie-pediatrica": {
    src: optimizedServiceImages[4].src,
    width: 384,
    height: 216,
  },
  "obstetrica-ginecologie": {
    src: optimizedServiceImages[5].src,
    width: 384,
    height: 216,
  },
  "ortopedie-traumatologie": {
    src: optimizedServiceImages[6].src,
    width: 384,
    height: 216,
  },
  nefrologie: { src: optimizedServiceImages[7].src, width: 384, height: 216 },
  "analize-laborator": {
    src: optimizedServiceImages[8].src,
    width: 384,
    height: 216,
  },
  dermatovenerologie: {
    src: optimizedServiceImages[9].src,
    width: 384,
    height: 216,
  },
  "medicina-muncii": {
    src: optimizedServiceImages[10].src,
    width: 384,
    height: 216,
  },
  "estetica-faciala": {
    src: optimizedServiceImages[11].src,
    width: 384,
    height: 216,
  },
  neurologie: { src: optimizedServiceImages[12].src, width: 384, height: 216 },

  // Coming soon services - optimized images
  reumatologie: {
    src: optimizedServiceImages[13].src,
    width: 384,
    height: 216,
  },
  pneumologie: { src: optimizedServiceImages[14].src, width: 384, height: 216 },
  endocrinologie: {
    src: optimizedServiceImages[15].src,
    width: 384,
    height: 216,
  },
  psihiatrie: { src: optimizedServiceImages[16].src, width: 384, height: 216 },
  "recuperare-medicala": {
    src: optimizedServiceImages[17].src,
    width: 384,
    height: 216,
  },
  alergologie: { src: optimizedServiceImages[18].src, width: 384, height: 216 },
  "ortopedie-pediatrica": {
    src: optimizedServiceImages[19].src,
    width: 384,
    height: 216,
  },
  "diabet-metabolism": {
    src: optimizedServiceImages[15].src,
    width: 384,
    height: 216,
  }, // Using endocrinologie

  // Servicii care sunt în coming soon dar au și pagină dedicată
  cardiologie: { src: optimizedServiceImages[20].src, width: 384, height: 216 },
  orl: { src: optimizedServiceImages[21].src, width: 384, height: 216 },
  oftalmologie: {
    src: optimizedServiceImages[22].src,
    width: 384,
    height: 216,
  },
  urologie: { src: optimizedServiceImages[23].src, width: 384, height: 216 },

  default: { src: optimizedServiceImages[0].src, width: 384, height: 216 },
};

// SEO optimization for services page - targeting medical services in București
const seoTitle =
  "Servicii Medicale București - Clinică Medicală Completă | ANN Medical Clinic";
const seoDescription =
  "Servicii medicale complete în București: cardiologie, dermatologie, ginecologie, pediatrie, neurologie, oftalmologie, ORL, urologie. Medici specializați și echipamente moderne la ANN Medical Clinic Bragadiru.";

const keywords = [
  "servicii medicale București",
  "clinică medicală București",
  "consultații medicale București",
  "medici specialiști București",
  "investigații medicale București",
  "cardiolog București",
  "dermatolog București",
  "ginecolog București",
  "pediatru București",
  "neurolog București",
  "oftalmolog București",
  "ORL București",
  "urolog București",
  "ortopedie București",
  "chirurgie București",
  "dermatovenerologie București",
  "nefrologie București",
  "medicina muncii București",
  "analize laborator București",
  "ANN Medical Clinic",
  "clinică Bragadiru",
  "servicii medicale Ilfov",
];

// Structured data for services page
const structuredData = {
  "@context": "https://schema.org",
  "@type": "MedicalOrganization",
  name: siteConfig.name,
  url: `${siteConfig.url}/servicii`,
  logo: `${siteConfig.url}/images/logo.png`,
  description: seoDescription,
  address: {
    "@type": "PostalAddress",
    streetAddress: "Strada Republicii, Nr. 15",
    addressLocality: "Bragadiru",
    addressRegion: "Ilfov",
    postalCode: "077025",
    addressCountry: "RO",
  },
  contactPoint: {
    "@type": "ContactPoint",
    telephone: siteConfig.contact.phone,
    contactType: "customer service",
    areaServed: ["București", "Ilfov", "România"],
    availableLanguage: "Romanian",
  },
  medicalSpecialty: [
    "Cardiologie",
    "Dermatologie",
    "Ginecologie",
    "Pediatrie",
    "Neurologie",
    "Oftalmologie",
    "ORL",
    "Urologie",
    "Ortopedie",
    "Chirurgie",
    "Medicina Familiei",
    "Medicina Internă",
    "Nefrologie",
    "Medicina Muncii",
  ],
  hasOfferCatalog: {
    "@type": "OfferCatalog",
    name: "Servicii Medicale",
    itemListElement: sortedServices.map((service, index) => ({
      "@type": "Offer",
      position: index + 1,
      name: service.data.name,
      description: service.data.description,
      url: `${siteConfig.url}/servicii/${service.slug}`,
      category: "Servicii Medicale",
    })),
  },
};

// Get available services (not coming soon)
const availableServices = sortedServices.filter(
  (service) => !service.data.comingSoon
);

// Get coming soon services
const comingSoonServices = sortedServices.filter(
  (service) => service.data.comingSoon
);

// Get featured services for highlighting
const featuredServices = availableServices.filter(
  (service) => service.data.featured
);

// Categories and specialties are handled by the components themselves
---

<BaseLayout
  title={seoTitle}
  description={seoDescription}
  keywords={keywords}
  structuredData={structuredData}
  canonicalUrl={`${siteConfig.url}/servicii`}
>
  <!-- Hero Section -->
  <section
    class="relative min-h-[60vh] flex items-center justify-center overflow-hidden bg-gradient-to-br from-primary/5 via-surface to-secondary/5"
  >
    <!-- Floating Particles Background -->
    <FloatingParticles client:load />

    <!-- Background Pattern -->
    <div class="absolute inset-0 opacity-5">
      <div
        class="absolute inset-0 bg-[radial-gradient(circle_at_30%_20%,rgba(13,148,136,0.3),transparent_50%)]"
      >
      </div>
      <div
        class="absolute inset-0 bg-[radial-gradient(circle_at_70%_80%,rgba(168,85,247,0.3),transparent_50%)]"
      >
      </div>
    </div>

    <div
      class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center"
    >
      <!-- Hero Content -->
      <div class="max-w-4xl mx-auto">
        <AnimatedText
          className="text-4xl sm:text-5xl lg:text-6xl font-bold text-text mb-6"
          client:load
        >
          Servicii Medicale Complete
        </AnimatedText>

        <div class="text-lg sm:text-xl text-text-muted mb-8 leading-relaxed">
          <p>
            Descoperă gama completă de servicii medicale oferite de ANN Medical
            Clinic. Medici specializați, echipamente moderne și îngrijire
            personalizată pentru sănătatea ta.
          </p>
        </div>

        <!-- Quick Stats -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mt-12">
          <div class="text-center">
            <div class="text-3xl font-bold text-primary mb-2">
              {availableServices.length}+
            </div>
            <div class="text-sm text-text-muted">Servicii Disponibile</div>
          </div>
          <div class="text-center">
            <div class="text-3xl font-bold text-secondary mb-2">14+</div>
            <div class="text-sm text-text-muted">Specialități</div>
          </div>
          <div class="text-center">
            <div class="text-3xl font-bold text-accent mb-2">15+</div>
            <div class="text-sm text-text-muted">Ani Experiență</div>
          </div>
          <div class="text-center">
            <div class="text-3xl font-bold text-primary-hover mb-2">24/7</div>
            <div class="text-sm text-text-muted">Urgențe</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Services Search -->
  <section class="py-12 bg-surface-secondary/50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <ServicesSearch services={sortedServices} client:load />
    </div>
  </section>

  <!-- Available Services Section -->
  <section class="py-16 bg-surface">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-12">
        <h2 class="text-3xl sm:text-4xl font-bold text-text mb-4">
          Servicii Disponibile Acum
        </h2>
        <p class="text-lg text-text-muted max-w-2xl mx-auto">
          Programează-te astăzi pentru consultații și investigații medicale de
          înaltă calitate
        </p>
      </div>

      <ServicesSection
        services={availableServices}
        serviceImages={serviceImages}
        backgroundImage={optimizedWelcomeImage.src}
        client:load
      />
    </div>
  </section>

  <!-- Coming Soon Services -->
  <section class="py-16 bg-surface-secondary/30">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-12">
        <h2 class="text-3xl sm:text-4xl font-bold text-text mb-4">
          Servicii în Curs de Dezvoltare
        </h2>
        <p class="text-lg text-text-muted max-w-2xl mx-auto">
          Extinderea continuă a gamei de servicii pentru a răspunde tuturor
          nevoilor tale medicale
        </p>
      </div>

      <ComingSoonSection
        services={comingSoonServices}
        serviceImages={serviceImages}
        backgroundImage={optimizedWelcomeImage.src}
        client:load
      />
    </div>
  </section>

  <!-- All Services Listing -->
  <section class="py-16 bg-surface">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-12">
        <h2 class="text-3xl sm:text-4xl font-bold text-text mb-4">
          Toate Serviciile
        </h2>
        <p class="text-lg text-text-muted max-w-2xl mx-auto">
          Explorează întreaga gamă de servicii medicale și găsește exact ce
          cauți
        </p>
      </div>

      <AllServicesListing
        services={sortedServices}
        serviceImages={serviceImages}
        client:load
      />
    </div>
  </section>
</BaseLayout>
