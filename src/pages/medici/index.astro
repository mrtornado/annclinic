---
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import DoctorsHero from "../../components/doctors/DoctorsHero";
import DoctorsListing from "../../components/doctors/DoctorsListing";

// Get all doctors and sort them by order and name
const doctors = await getCollection("doctors");
const sortedDoctors = doctors.sort((a, b) => {
  // First sort by order (featured doctors first)
  if (a.data.order !== b.data.order) {
    return a.data.order - b.data.order;
  }
  // Then sort by name
  return a.data.name.localeCompare(b.data.name);
});

// SEO data
const title = "Medici Specialiști București | Echipa Medicală ANN Clinic";
const description =
  "Echipa noastră de medici specialiști cu experiență vastă în cardiologie, ginecologie, dermatologie, pediatrie și alte specialități. Programări online disponibile.";
const keywords = [
  "medici specialiști București",
  "doctori București",
  "cardiolog București",
  "ginecolog București",
  "dermatolog București",
  "pediatru București",
  "ANN Clinic medici",
  "consultații medicale București",
];

// Structured data for medical team
const structuredData = {
  "@context": "https://schema.org",
  "@type": "MedicalOrganization",
  name: "ANN Clinic",
  url: "https://annclinic.ro/medici",
  description: description,
  address: {
    "@type": "PostalAddress",
    streetAddress: "Strada Exemplu 123",
    addressLocality: "Bragadiru",
    addressRegion: "Ilfov",
    postalCode: "077025",
    addressCountry: "RO",
  },
  employee: sortedDoctors.map((doctor) => ({
    "@type": "Person",
    name: doctor.data.name,
    jobTitle: "Medic Specialist",
    knowsAbout: doctor.data.specialties,
    image: doctor.data.photo,
    url: `https://annclinic.ro/medici/${doctor.slug}`,
  })),
};

const openGraph = {
  title: title,
  description: description,
  image: "/images/ann-clinic-og.jpg",
  imageAlt: "Echipa medicală ANN Clinic București",
  type: "website",
  url: "https://annclinic.ro/medici",
};
---

<BaseLayout
  title={title}
  description={description}
  keywords={keywords}
  canonicalUrl="https://annclinic.ro/medici"
  structuredData={structuredData}
  openGraph={openGraph}
>
  <DoctorsHero client:load />
  <DoctorsListing doctors={sortedDoctors} client:load />
</BaseLayout>
