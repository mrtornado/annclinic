---
import BaseLayout from "../layouts/BaseLayout.astro";
import HeroSection from "../components/home/HeroSection.tsx";
import WelcomeSection from "../components/home/WelcomeSection.tsx";
import ServicesSection from "../components/home/ServicesSection.tsx";
import ComingSoonSection from "../components/home/ComingSoonSection.tsx";
import ArticlesSection from "../components/home/ArticlesSection.tsx";
import { getCollection } from "astro:content";
import { siteConfig } from "../config/site";
import { Image, getImage } from "astro:assets";
import bgImage from "../assets/images/bg-image.jpg";
import welcomeImage from "../assets/images/welcome.webp";

// Import logos
import annLogo from "../assets/images/altfel-de-logo.png";
import synevoLogo from "../assets/images/synevo.png";

// Get services and articles data for React components
const services = await getCollection("services");
const articles = await getCollection("articles");

// Optimize images using getImage() with Sharp service configured for Node adapter
const optimizedBgImage = await getImage({
  src: bgImage,
  width: 1920,
  height: 1080,
  format: "webp",
  quality: 85,
});

const optimizedWelcomeImage = await getImage({
  src: welcomeImage,
  width: 600,
  height: 450,
  format: "webp",
  quality: 90,
});

const optimizedAnnLogo = await getImage({
  src: annLogo,
  width: 167, // Actual display size from PageSpeed
  height: 96,
  format: "webp",
  quality: 90,
});

const optimizedSynevoLogo = await getImage({
  src: synevoLogo,
  width: 140, // Actual display size from PageSpeed
  height: 64,
  format: "webp",
  quality: 90,
});

// Import service images for homepage - correctly mapped
import medicinaFamilieImg from "../assets/images/servicii/fam-scaled.webp";
import pediatrieImg from "../assets/images/servicii/pediatrrie.webp";
import medicinaInternaImg from "../assets/images/servicii/medicina-interna.webp";
import chirurgieGeneralaImg from "../assets/images/servicii/chirurgie.webp";
import chirurgiePediatricaImg from "../assets/images/servicii/CHIRURGIE-PEDIATRICA.webp";
import obstetricaGinecologieImg from "../assets/images/servicii/ginecologie.webp";
import ortopedieTraumatologieImg from "../assets/images/servicii/orto.webp";
import nefrologieImg from "../assets/images/servicii/nefrologie.webp";
import analizeLaboratorImg from "../assets/images/servicii/medicina-muncii.webp";
import dermatovenerologieImg from "../assets/images/servicii/dermatologie.webp";
import medicinaMunciiImg from "../assets/images/servicii/medicina-muncii.webp";
// Keep existing for other services
import cardiologieImg from "../assets/images/servicii/medicina-interna.webp";
import orlImg from "../assets/images/servicii/nefrologie.webp";
import esteticaImg from "../assets/images/servicii/chirurgie.webp";
import neurologieImg from "../assets/images/servicii/medicina-muncii.webp";
import oftalmologieImg from "../assets/images/servicii/orto.webp";
import urologieImg from "../assets/images/servicii/CHIRURGIE-PEDIATRICA.webp";

// Import coming soon service images
import reumatologieImgSoon from "../assets/images/servicii/soon/reumatologie.webp";
import pneumologieImgSoon from "../assets/images/servicii/soon/pneumologie.webp";
import endocrinologieImgSoon from "../assets/images/servicii/soon/endocrinologie.webp";
import psihiatrieImgSoon from "../assets/images/servicii/soon/psihiatrie.webp";
import recuperareMedicalaImgSoon from "../assets/images/servicii/soon/RECUPERARE-MEDICALA.webp";
import alergologieImgSoon from "../assets/images/servicii/soon/alergologie.webp";
import ortopediePediatricaImgSoon from "../assets/images/servicii/soon/ORTOPEDIE-PEDIATRICA.webp";
// Additional coming soon services (existing services moved to coming soon)
import cardiologieImgSoon from "../assets/images/servicii/soon/cardiologie.webp";
import orlImgSoon from "../assets/images/servicii/soon/ORL.webp";
import oftalmologieImgSoon from "../assets/images/servicii/soon/oftamologie.webp";
import urologieImgSoon from "../assets/images/servicii/soon/UROLOGIE.webp";

// Optimize service images to actual display size (384x216) using getImage()
const optimizedServiceImages = await Promise.all([
  getImage({ src: medicinaFamilieImg, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: pediatrieImg, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: medicinaInternaImg, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: chirurgieGeneralaImg, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: chirurgiePediatricaImg, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: obstetricaGinecologieImg, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: ortopedieTraumatologieImg, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: nefrologieImg, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: analizeLaboratorImg, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: dermatovenerologieImg, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: medicinaMunciiImg, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: esteticaImg, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: neurologieImg, width: 384, height: 216, format: "webp", quality: 85 }),
  // Coming soon services
  getImage({ src: reumatologieImgSoon, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: pneumologieImgSoon, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: endocrinologieImgSoon, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: psihiatrieImgSoon, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: recuperareMedicalaImgSoon, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: alergologieImgSoon, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: ortopediePediatricaImgSoon, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: cardiologieImgSoon, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: orlImgSoon, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: oftalmologieImgSoon, width: 384, height: 216, format: "webp", quality: 85 }),
  getImage({ src: urologieImgSoon, width: 384, height: 216, format: "webp", quality: 85 }),
]);

// Create service images mapping with optimized images
const homeServiceImages = {
  "medicina-familie": { src: optimizedServiceImages[0].src, width: 384, height: 216 },
  pediatrie: { src: optimizedServiceImages[1].src, width: 384, height: 216 },
  "medicina-interna": { src: optimizedServiceImages[2].src, width: 384, height: 216 },
  "chirurgie-generala": { src: optimizedServiceImages[3].src, width: 384, height: 216 },
  "chirurgie-pediatrica": { src: optimizedServiceImages[4].src, width: 384, height: 216 },
  "obstetrica-ginecologie": { src: optimizedServiceImages[5].src, width: 384, height: 216 },
  "ortopedie-traumatologie": { src: optimizedServiceImages[6].src, width: 384, height: 216 },
  nefrologie: { src: optimizedServiceImages[7].src, width: 384, height: 216 },
  "analize-laborator": { src: optimizedServiceImages[8].src, width: 384, height: 216 },
  dermatovenerologie: { src: optimizedServiceImages[9].src, width: 384, height: 216 },
  "medicina-muncii": { src: optimizedServiceImages[10].src, width: 384, height: 216 },
  "estetica-faciala": { src: optimizedServiceImages[11].src, width: 384, height: 216 },
  neurologie: { src: optimizedServiceImages[12].src, width: 384, height: 216 },
  // Coming soon services
  reumatologie: { src: optimizedServiceImages[13].src, width: 384, height: 216 },
  pneumologie: { src: optimizedServiceImages[14].src, width: 384, height: 216 },
  endocrinologie: { src: optimizedServiceImages[15].src, width: 384, height: 216 },
  psihiatrie: { src: optimizedServiceImages[16].src, width: 384, height: 216 },
  "recuperare-medicala": { src: optimizedServiceImages[17].src, width: 384, height: 216 },
  alergologie: { src: optimizedServiceImages[18].src, width: 384, height: 216 },
  "ortopedie-pediatrica": { src: optimizedServiceImages[19].src, width: 384, height: 216 },
  "diabet-metabolism": { src: optimizedServiceImages[15].src, width: 384, height: 216 }, // Using endocrinologie
  // Coming soon services that already exist but moved to coming soon
  cardiologie: { src: optimizedServiceImages[20].src, width: 384, height: 216 },
  orl: { src: optimizedServiceImages[21].src, width: 384, height: 216 },
  oftalmologie: { src: optimizedServiceImages[22].src, width: 384, height: 216 },
  urologie: { src: optimizedServiceImages[23].src, width: 384, height: 216 },
  default: { src: optimizedServiceImages[0].src, width: 384, height: 216 },
};
---

<BaseLayout
  title={siteConfig.title}
  description={siteConfig.description}
  keywords={[
    "clinică medicală București",
    "consultații medicale",
    "cardiolog București",
    "dermatolog București",
    "ginecolog București",
  ]}
>
  <!-- Hero Section - React Component -->
  <HeroSection
    backgroundImage={optimizedBgImage.src}
    annLogo={optimizedAnnLogo.src}
    synevoLogo={optimizedSynevoLogo.src}
    client:load
  />

  <!-- Welcome Section - React Component -->
  <WelcomeSection welcomeImage={optimizedWelcomeImage.src} client:load />

  <!-- Services Section - React Component -->
  <ServicesSection
    services={services}
    serviceImages={homeServiceImages}
    backgroundImage={optimizedWelcomeImage.src}
    client:load
  />

  <!-- Coming Soon Section - React Component -->
  <ComingSoonSection
    services={services}
    serviceImages={homeServiceImages}
    backgroundImage={optimizedWelcomeImage.src}
    client:load
  />

  <!-- Articles Section - React Component -->
  <ArticlesSection articles={articles} client:load />
</BaseLayout>
